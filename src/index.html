<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>D&D Tokenizer</title>
        <link rel="icon" href="./icons/180.png" type="image/png" />
        <link rel="apple-touch-icon" href="./icons/180.png" />
        <link rel="manifest" href="./app.webmanifest" />
        <link rel="stylesheet" href="./style.css" />
    </head>
    <body class="body">
        <header class="header">
            <h1 class="header__title">D&D Tokenizer</h1>
            <ul class="header__actions">
                <li>
                    <button class="header__action pwa-install-button">
                        Install
                    </button>
                </li>
                <li>
                    <button class="header__action load-image-button">
                        Load Image
                    </button>
                </li>
                <li>
                    <button class="header__action save-image-button">
                        Save Image
                    </button>
                </li>
                <!-- <li><button class="header__action">Dark Mode</button></li> -->
            </ul>
        </header>
        <aside class="aside">
            <section class="aside__section">
                <details>
                    <summary>Library</summary>
                    <div class="tokens">
                        <ul>
                            <li>Token 1</li>
                            <li>Token 2</li>
                            <li>Token 3</li>
                        </ul>
                    </div>
                </details>
            </section>
            <section class="aside__section">
                <details open>
                    <summary>Settings</summary>
                    <div class="settings">
                        <div class="settings__item">
                            <input
                                type="checkbox"
                                class="bg-color-input-toggler"
                            />
                            <label class="input-group"
                                >Background color:
                                <input
                                    type="color"
                                    class="color-input bg-color-input"
                                    value="#ffffff"
                                />
                            </label>
                        </div>
                        <div class="settings__item">
                            <input
                                type="checkbox"
                                class="border-color-input-toggler"
                            />
                            <label class="input-group"
                                >Border color:
                                <input
                                    type="range"
                                    class="border-color-input"
                                    min="-1"
                                    max="1"
                                    step="0.005"
                                    value="0"
                                />
                            </label>
                        </div>
                        <div class="settings__item">
                            <label class="input-group"
                                >Mask size:
                                <input
                                    type="number"
                                    class="mask-size-input"
                                    value="320"
                                />
                            </label>
                        </div>
                    </div>
                </details>
            </section>
            <section class="aside__section">
                <details open>
                    <summary>Borders</summary>
                    <div class="borders">
                        <ul class="borders__cards">
                            <li class="borders__card">
                                <button class="border__selector">
                                    <img
                                        src="./assets/dragon.png"
                                        alt="Dragon style border"
                                    />
                                </button>
                            </li>
                            <li class="borders__card">
                                <button class="border__selector">
                                    <img
                                        src="./assets/greek.png"
                                        alt="Greek style border"
                                    />
                                </button>
                            </li>
                            <li class="borders__card">
                                <button class="border__selector">
                                    <img
                                        src="./assets/chinese.png"
                                        alt="Chinese style border"
                                    />
                                </button>
                            </li>
                        </ul>
                    </div>
                </details>
            </section>
            <section class="aside__section">
                <details open>
                    <summary>Text</summary>
                    <div class="text">
                        <button class="add-text-button">Add text</button>
                        <button class="remove-text-button">Remove text</button>
                        <select class="text-font-selector"></select>

                        <label class="input-group"
                            >Text color:
                            <input
                                type="color"
                                class="color-input text-color-input"
                                value="#ff0066"
                            />
                        </label>

                        <label class="input-group"
                            >Text size:
                            <input
                                type="range"
                                class="text-size-input"
                                min="5"
                                max="256"
                                step="1"
                                value="24"
                            />
                        </label>
                    </div>
                </details>
            </section>
        </aside>
        <div class="editor">
            <div class="container">
                <canvas id="canvas"></canvas>
            </div>
        </div>
        <footer class="footer">
            <ul class="footer__items">
                <li class="footer__item">
                    Made by
                    <a
                        href="https://twitter.com/dark_mefody"
                        target="_blank"
                        rel="noopener"
                        >dark_mefody</a
                    >
                </li>
                <li class="footer__item">
                    <a href="#" target="_blank" rel="noopener"
                        >Edit on GitHub</a
                    >
                </li>
            </ul>
        </footer>

        <script src="./scripts/canvas.js" type="module"></script>

        <script>
            // Control Install PWA Button
            const installButton = document.querySelector('.pwa-install-button');

            window.addEventListener('DOMContentLoaded', () => {
                if (window.matchMedia('(display-mode: standalone)').matches) {
                    installButton.remove();
                } else {
                    installButton.classList.add('visible');
                }
            });

            if ('BeforeInstallPromptEvent' in window) {
                let installEvent = null;
                const onInstall = () => {
                    installButton.disabled = true;
                    installEvent = null;
                };

                window.addEventListener('beforeinstallprompt', (event) => {
                    event.preventDefault();
                    installEvent = event;
                    installButton.disabled = false;
                });

                installButton.addEventListener('click', async () => {
                    if (!installEvent) {
                        return;
                    }
                    installEvent.prompt();
                    const result = await installEvent.userChoice;
                    if (result.outcome === 'accepted') {
                        onInstall();
                    }
                });

                window.addEventListener('appinstalled', () => {
                    onInstall();
                });
            }
        </script>

        <script type="module">
            // import { Workbox } from 'workbox-window';
            // if ('serviceWorker' in navigator) {
            //     const wb = new Workbox('/sw.js');
            //     wb.register();
            // }
        </script>
    </body>
</html>

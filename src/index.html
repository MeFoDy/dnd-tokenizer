<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>D&D Tokenizer</title>
        <link rel="icon" href="./icons/180.png" type="image/png" />
        <link rel="apple-touch-icon" href="./icons/180.png" />
        <meta name="theme-color" content="#14213D" />
        <meta name="color-scheme" content="dark" />

        <meta
            name="description"
            content="Generate image tokens with fancy borders for D&D and other table games characters. Perfect for adding visuality to your gaming experience."
        />
        <meta name="author" content="Nikita Dubko" />

        <meta property="og:title" content="D&D Tokenizer" />
        <meta property="og:type" content="website" />
        <meta
            property="og:url"
            content="https://dnd-tokenizer-41471e.netlify.app"
        />
        <meta property="og:image" content="./screens/test1.jpg" />
        <meta
            property="og:description"
            content="Generate image tokens with fancy borders for D&D and other table games characters. Perfect for adding visuality to your gaming experience."
        />

        <meta name="twitter:card" content="summary_large_image" />
        <meta name="twitter:creator" content="@dark_mefody" />
        <meta name="twitter:title" content="D&D Tokenizer" />
        <meta
            name="twitter:description"
            content="Generate image tokens with fancy borders for D&D and other table games characters. Perfect for adding visuality to your gaming experience."
        />
        <meta name="twitter:image" content="./screens/test1.jpg" />

        <link rel="manifest" href="./app.webmanifest" />
        <link rel="stylesheet" href="./style.css" />
    </head>
    <body class="body">
        <header class="header">
            <h1 class="header__title">D&D Tokenizer</h1>
            <ul class="header__actions">
                <li>
                    <button class="header__action button pwa-install-button pwa-install-button_visible">
                        <i class="icon icon_install"></i> Install as PWA
                    </button>
                </li>
                <li>
                    <button class="header__action button load-image-button">
                        <i class="icon icon_load"></i> Load Image
                    </button>
                </li>
                <li>
                    <button class="header__action button save-image-button">
                        <i class="icon icon_save"></i> Save Token
                    </button>
                </li>
            </ul>
        </header>
        <aside class="aside">
            <section class="aside__section">
                <details>
                    <summary>About</summary>
                    <p>
                        Me and my friends love D&D! Sometimes we need to
                        generate image tokens (a.k.a. avatars) for our
                        characters or NPCs. This web app is a helper for such
                        generatings.
                    </p>
                    <p>
                        Load your character image, add a border to it, add some
                        text, and save your new token for your future games.
                    </p>
                    <p>Have a good game!</p>
                </details>
            </section>
            <section class="aside__section">
                <details open>
                    <summary>Settings</summary>
                    <div class="settings">
                        <div class="settings__item">
                            <label class="input-group"
                                >Background color:
                                <input
                                    type="color"
                                    class="color-input bg-color-input"
                                    value="#00ff66"
                                />
                            </label>
                            <input
                                type="checkbox"
                                class="bg-color-input-toggler input-checkbox"
                            />
                        </div>
                        <!-- <div class="settings__item">
                            <input
                                type="checkbox"
                                class="border-color-input-toggler"
                            />
                            <label class="input-group"
                                >Border color:
                                <input
                                    type="range"
                                    class="border-color-input"
                                    min="-1"
                                    max="1"
                                    step="0.005"
                                    value="0"
                                />
                            </label>
                        </div> -->
                        <div class="settings__item">
                            <label class="input-group"
                                >Mask size:
                                <input
                                    type="number"
                                    class="mask-size-input"
                                    value="320"
                                />
                            </label>
                        </div>
                    </div>
                </details>
            </section>
            <section class="aside__section">
                <details open>
                    <summary>Borders</summary>
                    <div class="borders">
                        <ul class="borders__cards">
                            <li class="borders__card">
                                <button class="border__selector">
                                    <img
                                        src="./assets/dragon.png"
                                        alt="Dragon style border"
                                    />
                                </button>
                            </li>
                            <li class="borders__card">
                                <button class="border__selector">
                                    <img
                                        src="./assets/greek.png"
                                        alt="Greek style border"
                                    />
                                </button>
                            </li>
                            <li class="borders__card">
                                <button class="border__selector">
                                    <img
                                        src="./assets/chinese.png"
                                        alt="Chinese style border"
                                    />
                                </button>
                            </li>
                            <li class="borders__card">
                                <button class="border__selector">
                                    <img
                                        src="./assets/basic.png"
                                        alt="Basic style border"
                                    />
                                </button>
                            </li>
                            <li class="borders__card">
                                <button class="border__selector">
                                    <img
                                        src="./assets/xmas.png"
                                        alt="X-Mas style border"
                                    />
                                </button>
                            </li>
                            <li class="borders__card">
                                <button class="border__selector">
                                    <img
                                        src="./assets/halloween.png"
                                        alt="Halloween style border"
                                    />
                                </button>
                            </li>
                        </ul>
                    </div>
                </details>
            </section>
            <section class="aside__section">
                <details open>
                    <summary>Text</summary>
                    <div class="text">
                        <div class="text__controls">
                            <button class="add-text-button button">
                                <i class="icon icon_plus"></i> Add text
                            </button>
                            <button class="remove-text-button button">
                                <i class="icon icon_minus"></i> Remove text
                            </button>
                        </div>
                        <div class="text__settings hidden">
                            <div class="select-wrapper">
                                <select
                                    class="text-font-selector button select"
                                ></select>
                            </div>

                            <label class="input-group"
                                >Text color:
                                <input
                                    type="color"
                                    class="color-input text-color-input"
                                    value="#ff0066"
                                />
                            </label>

                            <label class="input-group"
                                >Text size:
                                <input
                                    type="range"
                                    class="input-range text-size-input"
                                    min="5"
                                    max="256"
                                    step="1"
                                    value="24"
                                />
                            </label>
                        </div>
                    </div>
                </details>
            </section>
        </aside>
        <div class="editor">
            <div class="container">
                <canvas id="canvas"></canvas>
            </div>
        </div>
        <footer class="footer">
            <ul class="footer__items">
                <li class="footer__item">
                    Made by
                    <a
                        href="https://twitter.com/dark_mefody"
                        target="_blank"
                        rel="noopener"
                        >dark_mefody</a
                    >
                </li>
                <li class="footer__item">
                    <a
                        href="https://github.com/MeFoDy/dnd-tokenizer"
                        target="_blank"
                        rel="noopener"
                        >Edit on GitHub</a
                    >
                </li>
            </ul>
        </footer>

        <script src="./scripts/canvas.js" type="module"></script>

        <script>
            // Control Install PWA Button
            const installButton = document.querySelector('.pwa-install-button');

            if ('BeforeInstallPromptEvent' in window) {
                let installEvent = null;
                const onInstall = () => {
                    installButton.disabled = true;
                    installEvent = null;
                };

                window.addEventListener('beforeinstallprompt', (event) => {
                    event.preventDefault();
                    installEvent = event;
                    installButton.disabled = false;
                });

                installButton.addEventListener('click', async () => {
                    if (!installEvent) {
                        return;
                    }
                    installEvent.prompt();
                    const result = await installEvent.userChoice;
                    if (result.outcome === 'accepted') {
                        onInstall();
                    }
                });

                window.addEventListener('appinstalled', () => {
                    onInstall();
                });
            }
        </script>

        <script type="module">
            import { Workbox } from 'workbox-window';
            if ('serviceWorker' in navigator) {
                const wb = new Workbox('/sw.js');
                wb.register();
            }
        </script>
    </body>
</html>
